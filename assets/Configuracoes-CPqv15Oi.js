const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SenhasTab-BW5djPtg.js","assets/ui-C_BmRRy8.js","assets/vendor-Psgnp9ei.js","assets/Card-C21MRrmW.js","assets/index-_MdAt-zn.js","assets/router-DVMx2JKX.js","assets/query-BI71cv7L.js","assets/supabase-CfsjXCJe.js","assets/icons-sb5RvF5O.js","assets/forms-BADiA78i.js","assets/utils-CwAUyRUs.js","assets/charts-C4lFoNLr.js","assets/index-CAhSAb_o.css","assets/Button-DjYkO9ZW.js","assets/ArquivosTab-CP7U5-Zo.js","assets/MetasTab-BimMjnr0.js","assets/goalService-Cb-uZcTs.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./supabase-CfsjXCJe.js";import{j as a}from"./ui-C_BmRRy8.js";import{a as s,r}from"./vendor-Psgnp9ei.js";import{B as o}from"./Button-DjYkO9ZW.js";import{A as t,g as n,l,m as i,b as c,a as d,k as m,n as u}from"./index-_MdAt-zn.js";import{GoalService as x}from"./goalService-Cb-uZcTs.js";import{S as h,O as g,T as b,J as p,X as f,E as j,e as v}from"./icons-sb5RvF5O.js";import"./router-DVMx2JKX.js";import"./query-BI71cv7L.js";import"./forms-BADiA78i.js";import"./utils-CwAUyRUs.js";import"./charts-C4lFoNLr.js";class y extends s.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,a){}render(){return this.state.hasError?this.props.fallback??a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"Ocorreu um erro ao carregar este conteúdo."}),a.jsx("div",{className:"text-gray-600 text-sm",children:"Tente novamente mais tarde ou recarregue a página."})]}):this.props.children}}const N=["Ong Mara","Liga Mara Formadas","Ong Decolagem","Liga Decolagem","Formação Liga","Pessoas Atendidas Decolagem","Famílias Embarcadas Decolagem","Diagnósticos Realizados","Imersão Ongs","Encontro líder Maras","Processo seletivo","Retenção Decolagem","Retenção Maras","Inadimplência","NPS","Outra"];function w({meta:e,setMeta:s,className:r}){return a.jsxs("div",{className:r,children:[a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Meta"}),a.jsxs("select",{value:e.nome,onChange:a=>s({...e,nome:a.target.value,nomePersonalizado:""}),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors",children:[a.jsx("option",{value:"",children:"Selecione o nome"}),N.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retenção Decolagem"===e.nome||"Retenção Maras"===e.nome?"Porcentagem (%)":"Quantidade"}),a.jsx("input",{type:"number",value:e.quantidade,onChange:a=>s({...e,quantidade:a.target.value}),placeholder:"Retenção Decolagem"===e.nome||"Retenção Maras"===e.nome?"Ex: 85":"Ex: 300",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors"}),("Retenção Decolagem"===e.nome||"Retenção Maras"===e.nome)&&a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Digite apenas o número (ex: 85 para 85%)"})]})]}),"Outra"===e.nome&&a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Meta Personalizada"}),a.jsx("input",{type:"text",value:e.nomePersonalizado,onChange:a=>s({...e,nomePersonalizado:a.target.value}),placeholder:"Digite o nome da meta personalizada",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors"})]})]})}function k({selectedMonths:e,setSelectedMonths:s,mesesDisponiveis:r,className:o}){return a.jsxs("div",{className:o,children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mês"}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-2 max-h-32 overflow-y-auto",children:a.jsx("div",{className:"space-y-1",children:r.map(o=>a.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-white rounded px-1 py-0.5 transition-colors",children:[a.jsx("input",{type:"checkbox",checked:"todo-ano"===o.value?e.includes("todo-ano"):e.includes(o.value),onChange:a=>((a,o)=>{if("todo-ano"===a)if(o){const e=r.filter(e=>"todo-ano"!==e.value).map(e=>e.value);s(["todo-ano",...e])}else s([]);else if(o){const o=[...e.filter(e=>"todo-ano"!==e),a],t=r.filter(e=>"todo-ano"!==e.value).map(e=>e.value).every(e=>o.includes(e));s(t?["todo-ano",...o]:o)}else{const r=e.filter(e=>e!==a&&"todo-ano"!==e);s(r)}})(o.value,a.target.checked),className:"mr-2 text-pink-500 focus:ring-pink-500 rounded"}),a.jsx("span",{className:"text-sm",children:o.label})]},o.value))})})]})}function S({year:e,setYear:s,className:r}){return a.jsxs("div",{className:r,children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ano"}),a.jsx("input",{type:"number",value:e,onChange:e=>s(e.target.value),placeholder:"2025",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors"})]})}function C({selectedRegionais:e,setSelectedRegionais:s,options:r,className:o}){return a.jsxs("div",{className:o,children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aplicar Meta para Área:"}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-2 max-h-32 overflow-y-auto",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-white rounded px-1 py-0.5 transition-colors",children:[a.jsx("input",{type:"checkbox",checked:e.length===r.length,onChange:e=>{return a=e.target.checked,void s(a?[...r]:[]);var a},className:"mr-2 text-pink-500 focus:ring-pink-500 rounded"}),a.jsx("span",{className:"text-sm font-medium",children:"Todas as Áreas"})]}),r.map(r=>a.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-white rounded px-1 py-0.5 transition-colors",children:[a.jsx("input",{type:"checkbox",checked:e.includes(r),onChange:a=>((a,r)=>{s(r?[...e,a]:e.filter(e=>e!==a))})(r,a.target.checked),className:"mr-2 text-pink-500 focus:ring-pink-500 rounded"}),a.jsx("span",{className:"text-sm",children:r})]},r))]})})]})}function E({onCancel:e,onSubmit:s,cancelLabel:r="Cancelar",submitLabel:t="Salvar",submitDisabled:n=!1,isSubmitting:l=!1,containerClassName:i="flex justify-end space-x-2 mt-4 pt-3 border-t border-gray-100",submitClassName:c="bg-pink-500 hover:bg-pink-600 text-white text-sm px-4 py-2 shadow-sm"}){return a.jsxs("div",{className:i,children:[a.jsx(o,{type:"button",variant:"outline",onClick:e,disabled:l,className:"text-sm px-4 py-2",children:r}),a.jsx(o,{onClick:s,className:c,disabled:n||l,children:l?"Processando...":t})]})}class M{static getAuthHeaders(){const e=localStorage.getItem("auth_token");return e?{Authorization:`Bearer ${e}`}:{}}static async createMember(e){try{const a=await fetch(`${t}/api/auth/users`,{method:"POST",headers:{...this.getAuthHeaders(),"Content-Type":"application/json"},body:JSON.stringify({email:e.email,nome:e.name,regional:e.regional_id,funcao:e.funcao,area:e.area,password:"123456",role:"user",tipo:"Colaborador",status:"ativo"})}),s=await a.json();if(!a.ok)throw new Error(s.error||"Erro ao criar usuário");return s.data}catch(a){throw new Error(a instanceof Error?a.message:"Erro ao criar usuário")}}static async getMembers(){try{const e=await fetch(`${t}/api/auth/users`,{headers:this.getAuthHeaders()}),a=await e.json();if(!e.ok)throw new Error(a.error||"Erro ao buscar usuários");return a.data||[]}catch(e){throw new Error(e instanceof Error?e.message:"Erro ao buscar usuários")}}static async updateMember(e,a){try{const s=await fetch(`${t}/api/auth/users/${e}`,{method:"PUT",headers:{...this.getAuthHeaders(),"Content-Type":"application/json"},body:JSON.stringify({nome:a.name,regional:a.regional_id,funcao:a.funcao,area:a.area})}),r=await s.json();if(!s.ok)throw new Error(r.error||"Erro ao atualizar usuário");return r.data}catch(s){throw new Error(s instanceof Error?s.message:"Erro ao atualizar usuário")}}static async deleteMember(e){try{const a=await fetch(`${t}/api/auth/users/${e}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!a.ok){const e=await a.json();throw new Error(e.error||"Erro ao deletar usuário")}}catch(a){throw new Error(a instanceof Error?a.message:"Erro ao deletar usuário")}}}const D=[{id:"senhas",name:"Senhas",icon:g},{id:"metas",name:"Metas",icon:b},{id:"arquivos",name:"Arquivos",icon:p}],_=["Comercial","Nacional","Líder Nacional","Diretor Operações","Líder Regional","Coordenador","Consultor","Diretor","Gerente","Outro"],T=["Todas as áreas","Nacional","Comercial","R. Centro-Oeste","R. MG/ES","R. Nordeste 1","R. Nordeste 2","R. Norte","R. Rio de Janeiro","R. Sul","R. São Paulo"],z=r.lazy(()=>e(()=>import("./SenhasTab-BW5djPtg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),P=r.lazy(()=>e(()=>import("./ArquivosTab-CP7U5-Zo.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10,11,12,13]))),q=r.lazy(()=>e(()=>import("./MetasTab-BimMjnr0.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10,11,12,13,16]))),A=a=>{switch(a){case"senhas":e(()=>import("./SenhasTab-BW5djPtg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]));break;case"metas":e(()=>import("./MetasTab-BimMjnr0.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10,11,12,13,16]));break;case"arquivos":e(()=>import("./ArquivosTab-CP7U5-Zo.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10,11,12,13]))}};function R(){const[e,s]=r.useState("senhas"),{showSuccess:g,showError:b,showConfirmation:p}=n(),N=l();r.useEffect(()=>{A("senhas"),A("arquivos")},[]),r.useEffect(()=>{const a=["senhas","metas","arquivos"],s=a.indexOf(e);if(-1!==s){const e=a[s+1]??a[s-1];e&&A(e)}},[e]);const[R,$]=r.useState(""),[F,O]=r.useState("Todas as funções"),[U,L]=r.useState("Todas as áreas"),[I,V]=r.useState(!1),[B,J]=r.useState(!1),[Y,G]=r.useState(null),[H,Q]=r.useState({nome:"",email:"",funcao:"",regional:""});r.useEffect(()=>{Y&&Q({nome:Y.name||"",email:Y.email||"",funcao:Y.funcao||"",regional:Y.area||Y.regional||""})},[Y]);const[K,W]=r.useState(""),[X,Z]=r.useState(!1),[ee,ae]=r.useState(null),{data:se,refetch:re}=i(),{data:oe,refetch:te}=c(),ne=r.useMemo(()=>oe&&0!==oe.length?oe.map((e,a)=>{var s;const r=e.banned_until&&new Date(e.banned_until)>new Date;return{id:e.id||`user-${a+1}`,auth_user_id:e.auth_user_id||e.id,usuario:e.nome||(null==(s=e.email)?void 0:s.split("@")[0])||"Usuário",email:e.email||"",tipo:e.tipo||("super_admin"===e.role?"Nacional":"Regional"),permissao:e.role||"membro",regional:e.regional||"Nacional",funcao:e.funcao||"Não definido",area:e.area||e.regional||"Não definido",status:r?"Bloqueado":"ativo"===e.status?"Ativo":"Inativo",criadoEm:e.created_at?new Date(e.created_at).toLocaleDateString("pt-BR"):"N/A",senha:"••••••••",banned_until:e.banned_until}}):[],[oe]),[le,ie]=r.useState(!1),[ce,de]=r.useState(!1),[me,ue]=r.useState(!1),[xe,he]=r.useState(!1),[ge,be]=r.useState(!1),[pe,fe]=r.useState(null),[je,ve]=r.useState(""),[ye,Ne]=r.useState("Todos"),[we,ke]=r.useState("Todos"),[Se,Ce]=r.useState("Todas"),[Ee,Me]=r.useState("Todas"),[De,_e]=r.useState(""),[Te,ze]=r.useState(!1),[Pe,qe]=r.useState({nome:"",email:"",funcao:"",regional:""}),[Ae,Re]=r.useState({nome:"",email:"",senha:"",tipo:"",permissao:"",regional:"",funcao:""}),[$e,Fe]=r.useState(!1),[Oe,Ue]=r.useState(!1),{data:Le,loading:Ie,error:Ve,refetch:Be}=d(),[Je,Ye]=r.useState({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]}),[Ge,He]=r.useState(null),[Qe,Ke]=r.useState(!1),We=["Centro-Oeste","MG/ES","Nordeste 1","Nordeste 2","Norte","Rio de Janeiro","São Paulo","Sul","Nacional","Comercial"],Xe=[{value:"todo-ano",label:"Todo o ano"},{value:"01",label:"Janeiro"},{value:"02",label:"Fevereiro"},{value:"03",label:"Março"},{value:"04",label:"Abril"},{value:"05",label:"Maio"},{value:"06",label:"Junho"},{value:"07",label:"Julho"},{value:"08",label:"Agosto"},{value:"09",label:"Setembro"},{value:"10",label:"Outubro"},{value:"11",label:"Novembro"},{value:"12",label:"Dezembro"}],Ze=async e=>{try{const a=localStorage.getItem("auth_token"),s=await fetch(`${t}/api/auth/users/${e}/block`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({duration:"24h"})});if(s.ok)await re(),g("Usuário bloqueado com sucesso!");else{const e=await s.json();b("Erro ao bloquear usuário",e.error)}}catch(a){b("Erro ao bloquear usuário")}},ea=async e=>{try{const a=localStorage.getItem("auth_token"),s=await fetch(`${t}/api/auth/users/${e}/unblock`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(s.ok)await re(),g("Usuário desbloqueado com sucesso!");else{const e=await s.json();b("Erro ao desbloquear usuário",e.error)}}catch(a){b("Erro ao desbloquear usuário")}},aa=async e=>{const a=ne.find(a=>a.auth_user_id===e);a?(fe(a),be(!0)):b("Usuário não encontrado")};r.useMemo(()=>(null==se?void 0:se.users)&&0!==se.users.length?se.users.filter(e=>{const a=(e.nome||e.name||"").toLowerCase().includes(R.toLowerCase()),s="Todas as funções"===F||e.funcao===F,r="Todas as áreas"===U||e.area===U;return a&&s&&r}):[],[se,R,F,U]);const sa=r.useMemo(()=>ne.filter(e=>{var a,s;const r=((null==(a=e.nome)?void 0:a.toLowerCase())||"").includes(je.toLowerCase())||((null==(s=e.email)?void 0:s.toLowerCase())||"").includes(je.toLowerCase()),o="Todos"===ye||e.role===ye,t="Todos"===we||"Ativo"===we&&"Ativo"===e.status||"Inativo"===we&&"Inativo"===e.status,n="Todas"===Se||e.funcao===Se,l="Todas"===Ee||e.area===Ee||e.regional===Ee;return r&&o&&t&&n&&l}),[ne,je,ye,we,Se,Ee]),ra=async()=>{try{if(!(null==Y?void 0:Y.id))return;const e={name:H.nome,email:H.email,funcao:H.funcao,area:H.regional};await M.updateMember(Y.id,e),await re(),G(null),Q({nome:"",email:"",funcao:"",regional:""}),g("Membro atualizado com sucesso!")}catch(e){b("Erro ao atualizar membro","Tente novamente.")}},oa=async e=>{try{const a=localStorage.getItem("auth_token"),s=await fetch(`${t}/api/auth/users/${e}/generate-password`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(s.ok){const e=await s.json();g("Nova senha gerada com sucesso!",`Senha temporária: ${e.password}\n\nAnote esta senha e repasse ao usuário. Por segurança, esta senha não será exibida novamente.`),await re()}else{const e=await s.json();b("Erro ao gerar nova senha",e.error)}}catch(a){b("Erro ao gerar nova senha")}},ta=()=>a.jsx(y,{fallback:a.jsx("div",{className:"p-6 text-red-600",children:"Falha ao carregar aba Senhas."}),children:a.jsx(r.Suspense,{fallback:a.jsxs("div",{className:"p-6 flex items-center gap-3 text-gray-500",children:[a.jsx(u,{size:"lg",color:"gray"}),a.jsx("span",{children:"Carregando Senhas..."})]}),children:a.jsx(z,{searchUsuarios:je,setSearchUsuarios:ve,filterTipo:ye,setFilterTipo:Ne,filterStatus:we,setFilterStatus:ke,filterFuncao:Se,setFilterFuncao:Ce,filterArea:Ee,setFilterArea:Me,filteredUsuarios:sa,setShowAddUserModal:ie,setSelectedUser:fe,setShowViewUserModal:de,setShowEditUserModal:ue,setShowResetPasswordModal:he,setShowDeleteUserModal:be,onBlockUser:Ze,onUnblockUser:ea,onDeleteUser:aa,onGeneratePassword:oa})})});return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx(h,{className:"w-8 h-8 text-blue-600"}),a.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Configurações"})]}),a.jsx("p",{className:"text-gray-600",children:"Painel administrativo"})]}),a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8",children:D.map(r=>{const o=r.icon;return a.jsxs("button",{onClick:()=>s(r.id),onMouseEnter:()=>A(r.id),onFocus:()=>A(r.id),className:`\n                      flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors\n                      ${e===r.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}\n                    `,children:[a.jsx(o,{className:"w-5 h-5"}),a.jsx("span",{children:r.name})]},r.id)})})})}),a.jsx("div",{children:(()=>{switch(e){case"senhas":default:return ta();case"metas":return a.jsx(y,{fallback:a.jsx("div",{className:"p-6 text-red-600",children:"Falha ao carregar aba Metas."}),children:a.jsx(r.Suspense,{fallback:a.jsxs("div",{className:"p-6 flex items-center gap-3 text-gray-500",children:[a.jsx(u,{size:"lg",color:"gray"}),a.jsx("span",{children:"Carregando Metas..."})]}),children:a.jsx(q,{metas:Le,setShowNewMetaModal:Ue,setEditingMeta:He,setNewMeta:Ye,setShowEditMetaModal:Ke,mesesDisponiveis:Xe,regionaisDisponiveis:We,metasLoading:Ie,metasError:Ve,refetchGoals:Be})})});case"arquivos":return a.jsx(y,{fallback:a.jsx("div",{className:"p-6 text-red-600",children:"Falha ao carregar aba Arquivos."}),children:a.jsx(r.Suspense,{fallback:a.jsxs("div",{className:"p-6 flex items-center gap-3 text-gray-500",children:[a.jsx(u,{size:"lg",color:"gray"}),a.jsx("span",{children:"Carregando Arquivos..."})]}),children:a.jsx(P,{})})})}})()})]}),I&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Adicionar Novo Membro"}),a.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("form",{className:"space-y-4",onSubmit:async e=>{var a;if(e.preventDefault(),Pe.nome.trim()&&(null==(a=Pe.email)?void 0:a.trim())){Fe(!0);try{const e={name:Pe.nome.trim(),email:Pe.email.trim(),regional_id:null,funcao:Pe.funcao||null,area:Pe.regional||null};await M.createMember(e),V(!1),qe({nome:"",email:"",funcao:"",regional:""}),N.success("Membro criado","Membro criado com sucesso!"),window.location.reload()}catch(s){N.error("Erro ao criar membro","Ocorreu um erro ao criar o membro. Tente novamente.")}finally{Fe(!1)}}else N.warning("Campos obrigatórios","Por favor, preencha todos os campos obrigatórios (nome e email).")},children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),a.jsx("input",{type:"text",value:Pe.nome,onChange:e=>qe(a=>({...a,nome:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o nome completo",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:Pe.email,onChange:e=>qe(a=>({...a,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o email",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),a.jsxs("select",{value:Pe.funcao,onChange:e=>qe(a=>({...a,funcao:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Selecione uma função"}),_.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Área"}),a.jsxs("select",{value:Pe.regional,onChange:e=>qe(a=>({...a,regional:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Selecione uma área"}),T.filter(e=>"Todas as áreas"!==e).map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{V(!1),qe({nome:"",email:"",funcao:"",regional:""})},disabled:$e,children:"Cancelar"}),a.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:$e,children:$e?"Adicionando...":"Adicionar Membro"})]})]})]})}),B&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Criar Nova Função"}),a.jsx("button",{onClick:()=>J(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("form",{className:"space-y-4",onSubmit:e=>{e.preventDefault(),ra()},children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Função"}),a.jsx("input",{type:"text",value:K,onChange:e=>W(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o nome da nova função"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{J(!1),W("")},children:"Cancelar"}),a.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",onClick:e=>{e.preventDefault(),K.trim()&&(J(!1),W(""))},children:"Criar Função"})]})]})]})}),Y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Editar Membro"}),a.jsx("button",{onClick:()=>G(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("form",{className:"space-y-4",onSubmit:e=>{e.preventDefault(),ra()},children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),a.jsx("input",{type:"text",value:H.nome,onChange:e=>Q(a=>({...a,nome:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:H.email,onChange:e=>Q(a=>({...a,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),a.jsxs("select",{value:H.funcao,onChange:e=>{Q(a=>({...a,funcao:e.target.value})),"Outro"===e.target.value&&J(!0)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Selecione uma função"}),_.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Área"}),a.jsxs("select",{value:H.regional,onChange:e=>Q(a=>({...a,regional:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Selecione uma área"}),T.filter(e=>"Todas as áreas"!==e).map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>G(null),children:"Cancelar"}),a.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Salvar Alterações"})]})]})]})}),X&&ee&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-red-600",children:"Confirmar Exclusão"}),a.jsx("button",{onClick:()=>{Z(!1),ae(null)},className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("p",{className:"text-gray-700",children:["Tem certeza que deseja excluir o membro ",a.jsx("strong",{children:ee.nome}),"?"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Esta ação não pode ser desfeita."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{Z(!1),ae(null)},children:"Cancelar"}),a.jsx(o,{onClick:async()=>{if(ee)try{await M.deleteMember(ee.id),N.success("Membro excluído","Membro excluído com sucesso!"),window.location.reload()}catch(e){N.error("Erro ao excluir membro","Erro ao excluir membro. Tente novamente.")}finally{Z(!1),ae(null)}},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),le&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Criar Novo Usuário"}),a.jsx("button",{onClick:()=>ie(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("form",{className:"space-y-4",onSubmit:async e=>{if(e.preventDefault(),Ae.nome.trim()&&Ae.email.trim()&&Ae.senha.trim()&&Ae.tipo&&Ae.permissao&&Ae.regional&&Ae.funcao){Fe(!0);try{const e={nome:Ae.nome,email:Ae.email,password:Ae.senha,role:Ae.permissao,tipo:Ae.tipo,regional:Ae.regional,funcao:Ae.funcao};await m.register(e),await Promise.all([te(),re()]),ie(!1),Re({nome:"",email:"",senha:"",tipo:"",permissao:"",regional:"",funcao:""}),N.success("Usuário criado","Usuário criado com sucesso!")}catch(a){N.error("Erro ao criar usuário","Erro ao criar usuário. Tente novamente.")}finally{Fe(!1)}}else N.warning("Campos obrigatórios","Por favor, preencha todos os campos obrigatórios.")},children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Usuário"}),a.jsx("input",{type:"text",value:Ae.nome,onChange:e=>Re(a=>({...a,nome:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o nome do usuário",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:Ae.email,onChange:e=>Re(a=>({...a,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o email",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),a.jsx("input",{type:"password",value:Ae.senha,onChange:e=>Re(a=>({...a,senha:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite a senha",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),a.jsxs("select",{value:Ae.tipo,onChange:e=>Re(a=>({...a,tipo:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione o tipo"}),a.jsx("option",{value:"Nacional",children:"Nacional"}),a.jsx("option",{value:"Regional",children:"Regional"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permissão"}),a.jsxs("select",{value:Ae.permissao,onChange:e=>Re(a=>({...a,permissao:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione a permissão"}),a.jsx("option",{value:"super_admin",children:"Super Admin"}),a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"user",children:"Usuário"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),a.jsxs("select",{value:Ae.funcao,onChange:e=>Re(a=>({...a,funcao:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione a função"}),_.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Área"}),a.jsxs("select",{value:Ae.regional,onChange:e=>Re(a=>({...a,regional:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione a área"}),T.slice(1).map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{ie(!1),Re({nome:"",email:"",senha:"",tipo:"",permissao:"",regional:"",funcao:""})},disabled:$e,children:"Cancelar"}),a.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:$e,children:$e?"Criando...":"Criar Usuário"})]})]})]})}),ce&&pe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Detalhes do Usuário"}),a.jsx("button",{onClick:()=>{de(!1),fe(null)},className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.usuario})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.tipo})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Permissão"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.permissao})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Regional"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.regional})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.status})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Senha"}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("p",{className:"text-gray-900 font-mono",children:Te?pe.senha||"123456":"••••••••"}),a.jsx("button",{type:"button",onClick:()=>ze(!Te),className:"text-gray-400 hover:text-gray-600",title:Te?"Ocultar senha":"Mostrar senha",children:Te?a.jsx(j,{className:"w-4 h-4"}):a.jsx(v,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Criado em"}),a.jsx("p",{className:"text-gray-900 mt-1",children:pe.criadoEm})]})]}),a.jsx("div",{className:"flex justify-end pt-6",children:a.jsx(o,{onClick:()=>{de(!1),fe(null),ze(!1)},children:"Fechar"})})]})}),me&&pe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"Editar Usuário"}),a.jsx("button",{onClick:()=>{ue(!1),fe(null)},className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!pe)return;const a=new FormData(e.target),s={nome:a.get("nome"),email:a.get("email"),tipo:a.get("tipo"),role:a.get("role"),funcao:a.get("funcao"),regional:a.get("regional")};try{const e=localStorage.getItem("auth_token"),a=await fetch(`${t}/api/auth/users/${pe.auth_user_id}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(a.ok){await a.json();await re(),ue(!1),fe(null),g("Usuário atualizado com sucesso!")}else{const e=await a.json();b("Erro ao atualizar usuário",e.error)}}catch(r){b("Erro ao atualizar usuário")}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Usuário"}),a.jsx("input",{type:"text",name:"nome",defaultValue:pe.usuario,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",name:"email",defaultValue:pe.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",spellCheck:"false",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),a.jsxs("select",{name:"tipo",defaultValue:pe.tipo||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione o tipo"}),a.jsx("option",{value:"Nacional",children:"Nacional"}),a.jsx("option",{value:"Regional",children:"Regional"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permissão"}),a.jsxs("select",{name:"role",defaultValue:pe.permissao,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"super_admin",children:"Super Admin"}),a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"user",children:"Usuário"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),a.jsxs("select",{name:"funcao",defaultValue:pe.funcao||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione a função"}),_.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Área"}),a.jsxs("select",{name:"regional",defaultValue:pe.regional||pe.area||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[a.jsx("option",{value:"",children:"Selecione a área"}),T.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{ue(!1),fe(null),ze(!1)},children:"Cancelar"}),a.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Salvar Alterações"})]})]})]})}),xe&&pe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-orange-600",children:"Definir Nova Senha"}),a.jsx("button",{onClick:()=>{he(!1),fe(null),_e(""),ze(!1)},className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("p",{className:"text-gray-700 mb-4",children:["Definir nova senha para o usuário ",a.jsx("strong",{children:pe.usuario}),":"]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nova Senha"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:Te?"text":"password",value:De,onChange:e=>_e(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent pr-10",placeholder:"Digite a nova senha"}),a.jsx("button",{type:"button",onClick:()=>ze(!Te),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:Te?a.jsx(j,{className:"w-4 h-4"}):a.jsx(v,{className:"w-4 h-4"})})]})]})}),a.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"Você deverá enviar esta senha para o usuário através dos canais apropriados."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{he(!1),fe(null),_e(""),ze(!1)},children:"Cancelar"}),a.jsx(o,{className:"bg-orange-600 hover:bg-orange-700",onClick:async()=>{if(pe&&De.trim())try{await m.updateUserPassword(pe.auth_user_id,De),await re(),he(!1),fe(null),_e(""),ze(!1),N.success("Senha redefinida",`Nova senha definida com sucesso para ${pe.usuario}.`)}catch(e){N.error("Erro","Erro ao definir nova senha")}else N.warning("Senha obrigatória","Por favor, digite uma nova senha.")},children:"Definir Senha"})]})]})}),ge&&pe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-red-600",children:"Confirmar Exclusão"}),a.jsx("button",{onClick:()=>{be(!1),fe(null)},className:"text-gray-400 hover:text-gray-600",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("p",{className:"text-gray-700",children:["Tem certeza que deseja excluir o usuário ",a.jsx("strong",{children:pe.usuario}),"?"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Esta ação não pode ser desfeita e o usuário perderá acesso ao sistema."})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx(o,{type:"button",variant:"outline",onClick:()=>{be(!1),fe(null)},children:"Cancelar"}),a.jsx(o,{onClick:async()=>{if(pe)try{const a=localStorage.getItem("auth_token"),s=await fetch(`${t}/api/auth/users/${pe.auth_user_id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(s.ok)await re(),be(!1),fe(null),g("Usuário excluído com sucesso!");else{let a="Erro ao excluir usuário";try{a=(await s.json()).error||a}catch(e){}b("Erro ao excluir usuário",a)}}catch(a){b("Erro ao excluir usuário")}},className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),Oe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-5 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nova Meta"}),a.jsx("button",{onClick:()=>{Ue(!1),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]})},className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(w,{meta:Je,setMeta:Ye}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsx(k,{selectedMonths:Je.mes,setSelectedMonths:e=>Ye({...Je,mes:e}),mesesDisponiveis:Xe}),a.jsx(S,{year:Je.ano,setYear:e=>Ye({...Je,ano:e})}),a.jsx(C,{selectedRegionais:Je.regionais,setSelectedRegionais:e=>Ye({...Je,regionais:e}),options:We})]})]}),a.jsx(E,{onCancel:()=>{Ue(!1),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]})},onSubmit:async e=>{if(e.preventDefault(),Je.nome.trim()&&Je.quantidade.trim()&&0!==Je.mes.length&&0!==Je.regionais.length){Fe(!0);try{const e="Outra"===Je.nome.trim()?Je.nomePersonalizado.trim():Je.nome.trim(),a=parseFloat(Je.quantidade),s=Je.mes.join(", "),r=Je.regionais.join(", "),o=`Meta: ${a}${"Retenção Decolagem"===Je.nome||"Retenção Maras"===Je.nome?"%":"Pessoas Atendidas Decolagem"===Je.nome||"Famílias Embarcadas Decolagem"===Je.nome||"Pessoas Atendidas"===Je.nome?" pessoas":"Diagnósticos Realizados"===Je.nome?" diagnósticos":" unidades"} | Meses: ${s} | Área: ${r}`;let t;if(0===Je.mes.length||Je.mes.includes("todo-ano"))t=12;else{const e=Je.mes.map(e=>parseInt(e)).filter(e=>!isNaN(e)&&e>=1&&e<=12);t=e.length>0?Math.max(...e):12}const n={nome:e,descricao:o,valor_meta:a,valor_atual:0,due_date:`${Je.ano}-${t.toString().padStart(2,"0")}-31`,status:"pending"};await x.createGoal(n);await Be(),Ue(!1),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]}),N.success("Meta criada","Meta criada com sucesso!")}catch(a){N.error("Erro ao criar meta",a instanceof Error?a.message:"Erro ao criar meta. Tente novamente.")}finally{Fe(!1)}}else N.warning("Campos obrigatórios","Por favor, preencha todos os campos obrigatórios.")},cancelLabel:"Cancelar",submitLabel:$e?"Criando...":"Criar Meta",submitDisabled:$e||!("Outra"===Je.nome?Je.nomePersonalizado.trim():Je.nome)||!Je.quantidade||0===Je.mes.length||!Je.ano||0===Je.regionais.length,isSubmitting:$e})]})}),Qe&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-5 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Editar Meta"}),a.jsx("button",{onClick:()=>{Ke(!1),He(null),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]})},className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100",children:a.jsx(f,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(w,{meta:Je,setMeta:Ye}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsx(k,{selectedMonths:Je.mes,setSelectedMonths:e=>Ye({...Je,mes:e}),mesesDisponiveis:Xe}),a.jsx(S,{year:Je.ano,setYear:e=>Ye({...Je,ano:e})})]}),a.jsx(C,{selectedRegionais:Je.regionais,setSelectedRegionais:e=>Ye({...Je,regionais:e}),options:We})]}),a.jsx(E,{onCancel:()=>{Ke(!1),He(null),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]})},onSubmit:async()=>{const e="Outra"===Je.nome?Je.nomePersonalizado.trim():Je.nome;if(e&&Je.quantidade&&Je.mes.length>0&&Je.ano&&Je.regionais.length>0){const a=parseFloat(Je.quantidade),s=Je.mes.join(", "),r=Je.regionais.join(", "),o=`Meta: ${a}${"Retenção Decolagem"===Je.nome||"Retenção Maras"===Je.nome?"%":"Pessoas Atendidas Decolagem"===Je.nome||"Famílias Embarcadas Decolagem"===Je.nome||"Pessoas Atendidas"===Je.nome?" pessoas":"Diagnósticos Realizados"===Je.nome?" diagnósticos":" unidades"} | Meses: ${s} | Área: ${r}`;let t;if(0===Je.mes.length||Je.mes.includes("todo-ano"))t=12;else{const e=Je.mes.map(e=>parseInt(e)).filter(e=>!isNaN(e)&&e>=1&&e<=12);t=e.length>0?Math.max(...e):12}const n=`${Je.ano}-${t.toString().padStart(2,"0")}-31`;await x.updateGoal(Ge.id,{nome:e,descricao:o,valor_meta:a,due_date:n}),await Be(),Ke(!1),He(null),Ye({nome:"",nomePersonalizado:"",quantidade:"",mes:[],ano:(new Date).getFullYear().toString(),regionais:[]})}},cancelLabel:"Cancelar",submitLabel:"Salvar Alterações",submitDisabled:!("Outra"===Je.nome?Je.nomePersonalizado.trim():Je.nome)||!Je.quantidade||0===Je.mes.length||!Je.ano||0===Je.regionais.length})]})})]})}export{R as default};
