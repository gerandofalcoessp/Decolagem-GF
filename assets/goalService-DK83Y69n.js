import{A as e}from"./index-3h40CfT8.js";import"./ui-C_BmRRy8.js";import"./vendor-Psgnp9ei.js";import"./router-DVMx2JKX.js";import"./query-BI71cv7L.js";import"./supabase-CfsjXCJe.js";import"./icons-sb5RvF5O.js";import"./forms-BADiA78i.js";import"./utils-CwAUyRUs.js";import"./charts-C4lFoNLr.js";class t{static getAuthHeaders(){const e=localStorage.getItem("auth_token");return e?{Authorization:`Bearer ${e}`}:{}}static adaptGoalToFrontend(e){var t;let o=["todo-ano"],a=["SP"],r=(new Date).getFullYear().toString();if(e.due_date){const t=new Date(e.due_date);r=t.getFullYear().toString(),o=[(t.getMonth()+1).toString().padStart(2,"0")]}if(e.descricao){const t=e.descricao.match(/(?:mês|meses|período):\s*([^|,\n]+)/i);if(t){const e=t[1].trim().toLowerCase();if(e.includes("todo")||e.includes("ano"))o=["todo-ano"];else{const t={janeiro:"01",fevereiro:"02","março":"03",abril:"04",maio:"05",junho:"06",julho:"07",agosto:"08",setembro:"09",outubro:"10",novembro:"11",dezembro:"12",jan:"01",fev:"02",mar:"03",abr:"04",mai:"05",jun:"06",jul:"07",ago:"08",set:"09",out:"10",nov:"11",dez:"12"},a=e.split(/[,;]/).map(e=>{const o=e.trim().toLowerCase();return t[o]||o}).filter(Boolean);a.length>0&&(o=a)}}const r=e.descricao.match(/(?:regional|regionais|área|áreas):\s*([^|\n]+)/i);if(r){const e=r[1].trim(),t={nacional:"nacional",comercial:"comercial","centro-oeste":"centro_oeste","centro oeste":"centro_oeste","mg/es":"mg_es","mg es":"mg_es","minas gerais":"mg_es","espirito santo":"mg_es","nordeste 1":"nordeste_1",nordeste1:"nordeste_1","nordeste 2":"nordeste_2",nordeste2:"nordeste_2",norte:"norte",rj:"rj","rio de janeiro":"rj",sp:"sp","são paulo":"sp","sao paulo":"sp",sul:"sul"};if(e.toLowerCase().includes("todas"))a=["centro_oeste","mg_es","nordeste_1","nordeste_2","norte","rj","sp","sul","nacional","comercial"];else if("nacional"===e.toLowerCase().trim())a=["nacional"];else{a=e.split(",").map(e=>e.trim()).map(e=>{const o=e.toLowerCase().trim();return t[o]||o}).filter(e=>e)}}}return{id:e.id,nome:e.nome||"Meta sem nome",descricao:e.descricao,quantidade:(null==(t=e.valor_meta)?void 0:t.toString())||"0",mes:o,ano:r,regionais:a,titulo:e.nome||"Meta sem nome",valorMeta:e.valor_meta||0,valorAtual:e.valor_atual||0,dataInicio:e.created_at,dataFim:e.due_date,status:"completed"===e.status?"concluida":"in_progress"===e.status?"em_andamento":"pendente",equipe:"Equipe Nacional",regional:a.join(", ")}}static async createGoal(t){try{const o=await fetch(`${e}/api/goals`,{method:"POST",headers:{...this.getAuthHeaders(),"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await o.json();if(!o.ok)throw new Error(a.error||"Erro ao criar meta");return this.adaptGoalToFrontend(a.data)}catch(o){throw new Error(o instanceof Error?o.message:"Erro ao criar meta")}}static async getGoals(){try{const t=await fetch(`${e}/api/goals`,{headers:this.getAuthHeaders()}),o=await t.json();if(!t.ok)throw new Error(o.error||"Erro ao buscar metas");return(o.data||[]).map(e=>this.adaptGoalToFrontend(e))}catch(t){throw new Error(t instanceof Error?t.message:"Erro ao buscar metas")}}static async updateGoal(t,o){try{const a=await fetch(`${e}/api/goals/${t}`,{method:"PUT",headers:{...this.getAuthHeaders(),"Content-Type":"application/json"},body:JSON.stringify(o)}),r=await a.json();if(!a.ok)throw new Error(r.error||"Erro ao atualizar meta");return this.adaptGoalToFrontend(r.data)}catch(a){throw new Error(a instanceof Error?a.message:"Erro ao atualizar meta")}}static async deleteGoal(t){try{const o=await fetch(`${e}/api/goals/${t}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!o.ok){const e=await o.json();throw new Error(e.error||"Erro ao deletar meta")}}catch(o){throw new Error(o instanceof Error?o.message:"Erro ao deletar meta")}}}export{t as GoalService};
